{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _this = this,\n    _jsxFileName = \"/Users/maya2/Desktop/Dev/Sites/Armazem-fit-store/site/afs-next-app/components/lojas/BuscaCampos.jsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from \"react\";\nimport Router from \"next/router\";\nimport PropTypes from \"prop-types\";\nimport styled from \"styled-components\";\nimport BuscaGeo from \"./BuscaGeo\";\nimport { getAbsoluteUrl } from \"../../helpers/url\";\nimport Select from \"../formulario/Select\";\nimport ListaLojas from \"./ListaLojas\";\nvar BuscaWrapper = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  .erro-geo {\\n    text-align: center;\\n    margin: 0.5rem auto;\\n    color: \", \";\\n  }\\n\"])), function (props) {\n  return props.theme.client.colors.laranja;\n});\n_c = BuscaWrapper;\nvar Inputs = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: repeat(auto-fit, minmax(14rem, 20rem));\\n  align-items: center;\\n  justify-content: center;\\n  grid-gap: 1.5rem;\\n  padding: 1rem 1rem;\\n  .select-input {\\n    background: #eaeaea;\\n    width: 14rem;\\n    border-radius: 5rem;\\n  }\\n\"])));\n_c2 = Inputs;\nvar Resultados = styled.ul(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\"])));\n_c3 = Resultados;\n\nvar compilaUfs = function compilaUfs(lojas) {\n  return lojas ? lojas.reduce(function (total, _ref) {\n    var endereco = _ref.endereco;\n\n    if (endereco && !total.includes(endereco.uf)) {\n      return [].concat(_toConsumableArray(total), [endereco.uf]);\n    }\n\n    return total;\n  }, []).sort(function (a, b) {\n    return a > b ? 1 : -1;\n  }) : [];\n};\n\nvar compilaCidades = function compilaCidades(lojas) {\n  return lojas ? lojas.reduce(function (total, _ref2) {\n    var endereco = _ref2.endereco;\n\n    if (endereco && !total.includes(endereco.cidade)) {\n      return [].concat(_toConsumableArray(total), [endereco.cidade]);\n    }\n\n    return total;\n  }, []).sort(function (a, b) {\n    return a > b ? 1 : -1;\n  }) : [];\n};\n\nvar lojasPorUf = function lojasPorUf(lojas, uf) {\n  return uf ? lojas.filter(function (_ref3) {\n    var endereco = _ref3.endereco;\n    return endereco && endereco.uf === uf;\n  }) : [];\n};\n\nvar cidadesPorUf = function cidadesPorUf(lojas, uf) {\n  return uf ? lojasPorUf(lojas, uf).reduce(function (total, _ref4) {\n    var endereco = _ref4.endereco;\n\n    if (endereco && !total.includes(endereco.cidade)) {\n      return [].concat(_toConsumableArray(total), [endereco.cidade]);\n    }\n\n    return total;\n  }, []).sort(function (a, b) {\n    return a > b ? 1 : -1;\n  }) : [];\n};\n\nvar lojasPorCidade = function lojasPorCidade(lojas, cidade) {\n  return cidade ? lojas.filter(function (_ref5) {\n    var endereco = _ref5.endereco;\n    return endereco && endereco.cidade === cidade;\n  }) : [];\n};\n\nvar BuscaCampos = function BuscaCampos(_ref6) {\n  _s();\n\n  var modo = _ref6.modo;\n\n  var _useState = useState([]),\n      lojas = _useState[0],\n      setLojas = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      ufEscolhido = _useState2[0],\n      setUfEscolhido = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      cidadeEscolhida = _useState3[0],\n      setCidadeEscolhida = _useState3[1];\n\n  var _useState4 = useState(false),\n      erroCidadeGeo = _useState4[0],\n      setErroCidadeGeo = _useState4[1];\n\n  var buscaLojas = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$yield$fetch$js, lojasEncontradas;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"\".concat(getAbsoluteUrl(\"front\"), \"/api/lojas\"));\n\n            case 2:\n              _context.next = 4;\n              return _context.sent.json();\n\n            case 4:\n              _yield$yield$fetch$js = _context.sent;\n              lojasEncontradas = _yield$yield$fetch$js.lojas;\n              // salva as loja\n              setLojas(lojasEncontradas);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function buscaLojas() {\n      return _ref7.apply(this, arguments);\n    };\n  }(); // carregando todas as lojas\n\n\n  useEffect(function () {\n    buscaLojas();\n  }, [\"once\"]);\n\n  var handleEstado = function handleEstado(_ref8) {\n    var value = _ref8.currentTarget.value;\n    setUfEscolhido(value);\n    setCidadeEscolhida(\"\");\n  };\n\n  var handleCidade = function handleCidade(_ref9) {\n    var value = _ref9.currentTarget.value;\n    setCidadeEscolhida(value);\n  };\n\n  var handleCidadeGeo = function handleCidadeGeo(cidadeGeo) {\n    var cidades = compilaCidades(lojas);\n\n    if (cidades.includes(cidadeGeo)) {\n      setCidadeEscolhida(cidadeGeo);\n    } else {\n      setErroCidadeGeo(true);\n    }\n  };\n\n  var ufs = compilaUfs(lojas);\n  var cidades = cidadesPorUf(lojas, ufEscolhido);\n  var lojasDisponiveis = lojasPorCidade(lojas, cidadeEscolhida); // se houver somente uma loja disponivel, ja faz o redir\n\n  if (lojasDisponiveis && lojasDisponiveis.length === 1 && modo !== \"balcao\") {\n    var _lojasDisponiveis = _slicedToArray(lojasDisponiveis, 1),\n        path = _lojasDisponiveis[0].path;\n\n    Router.push(\"/\".concat(path));\n  }\n\n  return __jsx(BuscaWrapper, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, __jsx(Inputs, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }, __jsx(Select, {\n    valores: ufs,\n    placeholder: \"Estado\",\n    handleInput: handleEstado,\n    valor: ufEscolhido,\n    nome: \"uf\",\n    carregando: !ufs.length,\n    className: \"select-input--tiny\",\n    valido: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }\n  }), __jsx(Select, {\n    valores: cidades,\n    placeholder: \"Cidade\",\n    handleInput: handleCidade,\n    valor: cidadeEscolhida,\n    nome: \"cidade\",\n    carregando: !ufs.length,\n    className: \"select-input--tiny\",\n    valido: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }), __jsx(BuscaGeo, {\n    erroCidadeGeo: erroCidadeGeo,\n    setCidade: handleCidadeGeo,\n    carregado: !!ufs.length,\n    setErroCidadeGeo: setErroCidadeGeo,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 9\n    }\n  })), __jsx(Resultados, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }\n  }, !!erroCidadeGeo && __jsx(\"p\", {\n    className: \"erro-geo\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, \"Ops! Algo deu errado. Por favor, busque usando os campos acima.\"), !!lojasDisponiveis.length && __jsx(ListaLojas, {\n    modo: modo,\n    lojasLinks: lojasDisponiveis,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 11\n    }\n  })));\n};\n\n_s(BuscaCampos, \"jzMPW9m6V2AkXBByi6O4lfhuOo0=\");\n\n_c4 = BuscaCampos;\nBuscaCampos.propTypes = {\n  modo: PropTypes.oneOf([\"balcao\", \"hotsite\"])\n};\nBuscaCampos.defaultProps = {\n  modo: \"hotsite\"\n};\nexport default BuscaCampos;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"BuscaWrapper\");\n$RefreshReg$(_c2, \"Inputs\");\n$RefreshReg$(_c3, \"Resultados\");\n$RefreshReg$(_c4, \"BuscaCampos\");","map":{"version":3,"sources":["/Users/maya2/Desktop/Dev/Sites/Armazem-fit-store/site/afs-next-app/components/lojas/BuscaCampos.jsx"],"names":["useState","useEffect","Router","PropTypes","styled","BuscaGeo","getAbsoluteUrl","Select","ListaLojas","BuscaWrapper","div","props","theme","client","colors","laranja","Inputs","Resultados","ul","compilaUfs","lojas","reduce","total","endereco","includes","uf","sort","a","b","compilaCidades","cidade","lojasPorUf","filter","cidadesPorUf","lojasPorCidade","BuscaCampos","modo","setLojas","ufEscolhido","setUfEscolhido","cidadeEscolhida","setCidadeEscolhida","erroCidadeGeo","setErroCidadeGeo","buscaLojas","fetch","json","lojasEncontradas","handleEstado","value","currentTarget","handleCidade","handleCidadeGeo","cidadeGeo","cidades","ufs","lojasDisponiveis","length","path","push","propTypes","oneOf","defaultProps"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport Router from \"next/router\";\nimport PropTypes from \"prop-types\";\nimport styled from \"styled-components\";\nimport BuscaGeo from \"./BuscaGeo\";\n\nimport { getAbsoluteUrl } from \"../../helpers/url\";\nimport Select from \"../formulario/Select\";\nimport ListaLojas from \"./ListaLojas\";\n\nconst BuscaWrapper = styled.div`\n  .erro-geo {\n    text-align: center;\n    margin: 0.5rem auto;\n    color: ${props => props.theme.client.colors.laranja};\n  }\n`;\n\nconst Inputs = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(14rem, 20rem));\n  align-items: center;\n  justify-content: center;\n  grid-gap: 1.5rem;\n  padding: 1rem 1rem;\n  .select-input {\n    background: #eaeaea;\n    width: 14rem;\n    border-radius: 5rem;\n  }\n`;\n\nconst Resultados = styled.ul``;\n\nconst compilaUfs = lojas =>\n  lojas\n    ? lojas\n        .reduce((total, { endereco }) => {\n          if (endereco && !total.includes(endereco.uf)) {\n            return [...total, endereco.uf];\n          }\n          return total;\n        }, [])\n        .sort((a, b) => (a > b ? 1 : -1))\n    : [];\n\nconst compilaCidades = lojas =>\n  lojas\n    ? lojas\n        .reduce((total, { endereco }) => {\n          if (endereco && !total.includes(endereco.cidade)) {\n            return [...total, endereco.cidade];\n          }\n          return total;\n        }, [])\n        .sort((a, b) => (a > b ? 1 : -1))\n    : [];\n\nconst lojasPorUf = (lojas, uf) =>\n  uf ? lojas.filter(({ endereco }) => endereco && endereco.uf === uf) : [];\n\nconst cidadesPorUf = (lojas, uf) =>\n  uf\n    ? lojasPorUf(lojas, uf)\n        .reduce((total, { endereco }) => {\n          if (endereco && !total.includes(endereco.cidade)) {\n            return [...total, endereco.cidade];\n          }\n          return total;\n        }, [])\n        .sort((a, b) => (a > b ? 1 : -1))\n    : [];\n\nconst lojasPorCidade = (lojas, cidade) =>\n  cidade\n    ? lojas.filter(({ endereco }) => endereco && endereco.cidade === cidade)\n    : [];\n\nconst BuscaCampos = ({ modo }) => {\n  const [lojas, setLojas] = useState([]);\n  const [ufEscolhido, setUfEscolhido] = useState(\"\");\n  const [cidadeEscolhida, setCidadeEscolhida] = useState(\"\");\n  const [erroCidadeGeo, setErroCidadeGeo] = useState(false);\n\n  const buscaLojas = async () => {\n    const { lojas: lojasEncontradas } = await (\n      await fetch(`${getAbsoluteUrl(\"front\")}/api/lojas`)\n    ).json();\n    // salva as loja\n    setLojas(lojasEncontradas);\n  };\n\n  // carregando todas as lojas\n  useEffect(() => {\n    buscaLojas();\n  }, [\"once\"]);\n\n  const handleEstado = ({ currentTarget: { value } }) => {\n    setUfEscolhido(value);\n    setCidadeEscolhida(\"\");\n  };\n\n  const handleCidade = ({ currentTarget: { value } }) => {\n    setCidadeEscolhida(value);\n  };\n\n  const handleCidadeGeo = cidadeGeo => {\n    const cidades = compilaCidades(lojas);\n    if (cidades.includes(cidadeGeo)) {\n      setCidadeEscolhida(cidadeGeo);\n    } else {\n      setErroCidadeGeo(true);\n    }\n  };\n\n  const ufs = compilaUfs(lojas);\n  const cidades = cidadesPorUf(lojas, ufEscolhido);\n  const lojasDisponiveis = lojasPorCidade(lojas, cidadeEscolhida);\n\n  // se houver somente uma loja disponivel, ja faz o redir\n  if (lojasDisponiveis && lojasDisponiveis.length === 1 && modo !== \"balcao\") {\n    const [{ path }] = lojasDisponiveis;\n    Router.push(`/${path}`);\n  }\n\n  return (\n    <BuscaWrapper>\n      <Inputs>\n        <Select\n          valores={ufs}\n          placeholder=\"Estado\"\n          handleInput={handleEstado}\n          valor={ufEscolhido}\n          nome=\"uf\"\n          carregando={!ufs.length}\n          className=\"select-input--tiny\"\n          valido\n        />\n        <Select\n          valores={cidades}\n          placeholder=\"Cidade\"\n          handleInput={handleCidade}\n          valor={cidadeEscolhida}\n          nome=\"cidade\"\n          carregando={!ufs.length}\n          className=\"select-input--tiny\"\n          valido\n        />\n        <BuscaGeo\n          erroCidadeGeo={erroCidadeGeo}\n          setCidade={handleCidadeGeo}\n          carregado={!!ufs.length}\n          setErroCidadeGeo={setErroCidadeGeo}\n        />\n      </Inputs>\n      <Resultados>\n        {!!erroCidadeGeo && (\n          <p className=\"erro-geo\">\n            Ops! Algo deu errado. Por favor, busque usando os campos acima.\n          </p>\n        )}\n        {!!lojasDisponiveis.length && (\n          <ListaLojas modo={modo} lojasLinks={lojasDisponiveis} />\n        )}\n      </Resultados>\n    </BuscaWrapper>\n  );\n};\n\nBuscaCampos.propTypes = {\n  modo: PropTypes.oneOf([\"balcao\", \"hotsite\"])\n};\n\nBuscaCampos.defaultProps = {\n  modo: \"hotsite\"\n};\n\nexport default BuscaCampos;\n"]},"metadata":{},"sourceType":"module"}