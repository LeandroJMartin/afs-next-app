{"ast":null,"code":"var _jsxFileName = \"/Users/maya2/Desktop/Dev/Sites/Armazem-fit-store/site/afs-next-app/components/vip/FaixaCadastro.jsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* eslint-disable consistent-return */\nimport { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport Router from \"next/router\";\nimport { getAbsoluteUrl } from \"../../helpers/url\";\nimport Container from \"../ui/containers/Container\";\nimport Input from \"../formulario/Input\";\nimport InputMasked from \"../formulario/InputMasked\";\nimport ButtonSucesso from \"../ui/buttons/ButtonSucesso\";\nimport CircleLoading from \"../ui/loadings/Circle\";\nimport { scrollToElement } from \"../../helpers/window\";\nimport { celularMask } from \"../../helpers/masks\";\nimport { validacao } from \"../../helpers/formularioVip\";\nimport PropTypes from \"prop-types\";\nconst Faixa = styled.div`\n  min-height: 4rem;\n  padding: 2rem 0;\n  background: ${props => props.theme.client.colors.verdeEscuro};\n\n  color: white;\n`;\nconst Conteudo = styled.div`\n  /* display: grid;\n  grid-gap: 1rem;\n  grid-template-columns: repeat(auto-fit, minmax(30rem, 1fr)); */\n\n  display: flex;\n  justify-content: space-between;\n\n  .loading-wrapper {\n    align-self: center;\n    justify-self: center;\n  }\n  .feedback {\n    font-size: 1.8rem;\n    font-weight: 500;\n    justify-self: center;\n  }\n\n  @media (max-width: 1030px) {\n    flex-direction: column;\n    align-items: center;\n  }\n`;\nconst Call = styled.div`\n  display: flex;\n  align-items: center;\n  p {\n    font-size: 1.8rem;\n    margin-left: 1rem;\n    text-align: center;\n    max-width: 30rem;\n    width: 100%;\n  }\n\n  @media (max-width: 1030px) {\n    margin-bottom: 2rem;\n  }\n`;\nconst Form = styled.form`\n  display: flex;\n  align-items: center;\n  max-width: 70rem;\n  width: 100%;\n  justify-content: space-between;\n\n  .inputs {\n    justify-content: space-between;\n    display: flex;\n    width: 100%;\n    margin: 0 2rem;\n\n    @media (max-width: 550px) {\n      flex-direction: column;\n      align-items: center;\n\n      div {\n        margin: 1rem 0;\n      }\n    }\n  }\n  .cadastro-vip-input {\n    max-width: 16rem;\n  }\n\n  @media ${props => props.theme.devices.tablet} {\n    flex-direction: column;\n    ${ButtonSucesso} {\n      margin-top: 2rem;\n    }\n  }\n`;\n\nconst FaixaCadastro = ({\n  unidade\n}) => {\n  const {\n    0: lead,\n    1: setLead\n  } = useState({\n    nome: \"\",\n    email: \"\",\n    celular: \"\",\n    url: \"\"\n  });\n  const {\n    0: status,\n    1: setStatus\n  } = useState(\"blank\");\n  const {\n    0: validado,\n    1: setValidado\n  } = useState(true);\n\n  const enviaLead = async leadData => {\n    const validou = validacao(leadData);\n\n    if (!validou) {\n      setValidado(false);\n      return false;\n    }\n\n    try {\n      setStatus(\"enviando\");\n      await (await fetch(`${getAbsoluteUrl(\"front\")}/api/fidelidade/criar`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(_objectSpread({}, leadData))\n      })).json();\n      setStatus(\"enviado\");\n      /*Integração RD Station*/\n\n      const integracaoRdStation = async () => {\n        return await fetch(\"https://www.rdstation.com.br/api/1.3/conversions\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            token_rdstation: \"3081eac95f9628db57a9ffcc563b2a30\",\n            identificador: \"Lista-Vip\",\n            email: lead.email,\n            nome: lead.nome,\n            celular: lead.celular,\n            url: lead.url,\n            unidade: unidade || \"\"\n          })\n        });\n      };\n\n      const integracao = async () => {\n        return await integracaoRdStation();\n      };\n\n      integracao(); // fazendo redir\n\n      setTimeout(() => {\n        window.sessionStorage.setItem(\"ListaVipPreenchida\", true);\n        Router.push(\"/lista-vip\");\n      }, 2000);\n    } catch (error) {\n      setStatus(\"erro\");\n    }\n  };\n\n  const handleInput = ({\n    currentTarget: {\n      value,\n      name\n    }\n  }) => {\n    setLead(_objectSpread(_objectSpread({}, lead), {}, {\n      [name]: value\n    }));\n  };\n\n  useEffect(() => {\n    // identifica se existe um submit get do form AMP -- users vindo das AMPs\n    const urlParams = new URLSearchParams(window.location.search);\n    const [nome, email] = [urlParams.get(\"nome\"), urlParams.get(\"email\")];\n\n    if (nome && email) {\n      // removendo parametros da url\n      scrollToElement(\".faixa-fidelidade\");\n      window.history.replaceState(null, null, window.location.pathname);\n      enviaLead({\n        nome,\n        email\n      });\n    }\n  }, [\"once\"]);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    lead.url = window.location.pathname;\n    enviaLead(lead);\n  };\n\n  return __jsx(Faixa, {\n    className: \"faixa-fidelidade\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 5\n    }\n  }, __jsx(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }\n  }, __jsx(Conteudo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  }, __jsx(Call, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 11\n    }\n  }, __jsx(\"picture\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }\n  }, __jsx(\"source\", {\n    type: \"image/webp\",\n    srcSet: \"/static/img/vip.webp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }\n  }), __jsx(\"source\", {\n    type: \"image/png\",\n    srcSet: \"/static/img/vip.png\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 15\n    }\n  }), __jsx(\"img\", {\n    alt: \"Programa Fidelidade\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 15\n    }\n  })), __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  }, \"Cadastre-se para participar do nosso programa fidelidade e receber descontos exclusivos!\")), status === \"blank\" && __jsx(Form, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"inputs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 15\n    }\n  }, __jsx(Input, {\n    nome: \"nome\",\n    placeholder: \"Seu nome\",\n    handleInput: handleInput,\n    valor: lead.nome,\n    valido: validado,\n    className: \"cadastro-vip-input\",\n    tipo: \"text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 17\n    }\n  }), __jsx(Input, {\n    nome: \"email\",\n    placeholder: \"Seu E-mail\",\n    handleInput: handleInput,\n    valor: lead.email,\n    valido: validado,\n    className: \"cadastro-vip-input\",\n    tipo: \"email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 17\n    }\n  }), __jsx(InputMasked, {\n    nome: \"celular\",\n    valor: lead.celular,\n    handleInput: handleInput,\n    placeholder: \"Celular/Whatsapp\",\n    valido: validado,\n    tipo: \"text\",\n    mask: celularMask,\n    className: \"cadastro-vip-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }\n  })), __jsx(ButtonSucesso, {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 15\n    }\n  }, \"Cadastrar\")), status === \"enviando\" && __jsx(\"div\", {\n    className: \"loading-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 13\n    }\n  }, __jsx(CircleLoading, {\n    corCliente: \"laranja\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 15\n    }\n  })), status === \"enviado\" && __jsx(\"span\", {\n    className: \"feedback\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 13\n    }\n  }, \"Obrigado. Aguarde novidades no seu e-mail!\"), status === \"erro\" && __jsx(\"span\", {\n    className: \"feedback\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 13\n    }\n  }, \"Ops, algo deu errado! Tente novamente mais tarde.\"))));\n};\n\nFaixaCadastro.propTypes = {\n  unidade: PropTypes.string\n};\nexport default FaixaCadastro;","map":{"version":3,"sources":["/Users/maya2/Desktop/Dev/Sites/Armazem-fit-store/site/afs-next-app/components/vip/FaixaCadastro.jsx"],"names":["useState","useEffect","styled","Router","getAbsoluteUrl","Container","Input","InputMasked","ButtonSucesso","CircleLoading","scrollToElement","celularMask","validacao","PropTypes","Faixa","div","props","theme","client","colors","verdeEscuro","Conteudo","Call","Form","form","devices","tablet","FaixaCadastro","unidade","lead","setLead","nome","email","celular","url","status","setStatus","validado","setValidado","enviaLead","leadData","validou","fetch","method","headers","body","JSON","stringify","json","integracaoRdStation","token_rdstation","identificador","integracao","setTimeout","window","sessionStorage","setItem","push","error","handleInput","currentTarget","value","name","urlParams","URLSearchParams","location","search","get","history","replaceState","pathname","handleSubmit","e","preventDefault","propTypes","string"],"mappings":"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","sourcesContent":["/* eslint-disable consistent-return */\nimport { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport Router from \"next/router\";\nimport { getAbsoluteUrl } from \"../../helpers/url\";\nimport Container from \"../ui/containers/Container\";\nimport Input from \"../formulario/Input\";\nimport InputMasked from \"../formulario/InputMasked\";\nimport ButtonSucesso from \"../ui/buttons/ButtonSucesso\";\nimport CircleLoading from \"../ui/loadings/Circle\";\nimport { scrollToElement } from \"../../helpers/window\";\nimport { celularMask } from \"../../helpers/masks\";\nimport { validacao } from \"../../helpers/formularioVip\";\n\nimport PropTypes from \"prop-types\";\n\nconst Faixa = styled.div`\n  min-height: 4rem;\n  padding: 2rem 0;\n  background: ${props => props.theme.client.colors.verdeEscuro};\n\n  color: white;\n`;\n\nconst Conteudo = styled.div`\n  /* display: grid;\n  grid-gap: 1rem;\n  grid-template-columns: repeat(auto-fit, minmax(30rem, 1fr)); */\n\n  display: flex;\n  justify-content: space-between;\n\n  .loading-wrapper {\n    align-self: center;\n    justify-self: center;\n  }\n  .feedback {\n    font-size: 1.8rem;\n    font-weight: 500;\n    justify-self: center;\n  }\n\n  @media (max-width: 1030px) {\n    flex-direction: column;\n    align-items: center;\n  }\n`;\n\nconst Call = styled.div`\n  display: flex;\n  align-items: center;\n  p {\n    font-size: 1.8rem;\n    margin-left: 1rem;\n    text-align: center;\n    max-width: 30rem;\n    width: 100%;\n  }\n\n  @media (max-width: 1030px) {\n    margin-bottom: 2rem;\n  }\n`;\n\nconst Form = styled.form`\n  display: flex;\n  align-items: center;\n  max-width: 70rem;\n  width: 100%;\n  justify-content: space-between;\n\n  .inputs {\n    justify-content: space-between;\n    display: flex;\n    width: 100%;\n    margin: 0 2rem;\n\n    @media (max-width: 550px) {\n      flex-direction: column;\n      align-items: center;\n\n      div {\n        margin: 1rem 0;\n      }\n    }\n  }\n  .cadastro-vip-input {\n    max-width: 16rem;\n  }\n\n  @media ${props => props.theme.devices.tablet} {\n    flex-direction: column;\n    ${ButtonSucesso} {\n      margin-top: 2rem;\n    }\n  }\n`;\n\nconst FaixaCadastro = ({ unidade }) => {\n  const [lead, setLead] = useState({\n    nome: \"\",\n    email: \"\",\n    celular: \"\",\n    url: \"\"\n  });\n  const [status, setStatus] = useState(\"blank\");\n\n  const [validado, setValidado] = useState(true);\n\n  const enviaLead = async leadData => {\n    const validou = validacao(leadData);\n\n    if (!validou) {\n      setValidado(false);\n      return false;\n    }\n\n    try {\n      setStatus(\"enviando\");\n      await (await fetch(`${getAbsoluteUrl(\"front\")}/api/fidelidade/criar`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          ...leadData\n        })\n      })).json();\n      setStatus(\"enviado\");\n\n      /*Integração RD Station*/\n      const integracaoRdStation = async () => {\n        return await fetch(\"https://www.rdstation.com.br/api/1.3/conversions\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            token_rdstation: \"3081eac95f9628db57a9ffcc563b2a30\",\n            identificador: \"Lista-Vip\",\n            email: lead.email,\n            nome: lead.nome,\n            celular: lead.celular,\n            url: lead.url,\n            unidade: unidade || \"\"\n          })\n        });\n      };\n\n      const integracao = async () => {\n        return await integracaoRdStation();\n      };\n      integracao();\n\n      // fazendo redir\n      setTimeout(() => {\n        window.sessionStorage.setItem(\"ListaVipPreenchida\", true);\n\n        Router.push(\"/lista-vip\");\n      }, 2000);\n    } catch (error) {\n      setStatus(\"erro\");\n    }\n  };\n\n  const handleInput = ({ currentTarget: { value, name } }) => {\n    setLead({ ...lead, [name]: value });\n  };\n\n  useEffect(() => {\n    // identifica se existe um submit get do form AMP -- users vindo das AMPs\n    const urlParams = new URLSearchParams(window.location.search);\n    const [nome, email] = [urlParams.get(\"nome\"), urlParams.get(\"email\")];\n    if (nome && email) {\n      // removendo parametros da url\n      scrollToElement(\".faixa-fidelidade\");\n      window.history.replaceState(null, null, window.location.pathname);\n      enviaLead({\n        nome,\n        email\n      });\n    }\n  }, [\"once\"]);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    lead.url = window.location.pathname;\n    enviaLead(lead);\n  };\n\n  return (\n    <Faixa className=\"faixa-fidelidade\">\n      <Container>\n        <Conteudo>\n          <Call>\n            <picture>\n              <source type=\"image/webp\" srcSet=\"/static/img/vip.webp\" />\n              <source type=\"image/png\" srcSet=\"/static/img/vip.png\" />\n              <img alt=\"Programa Fidelidade\" />\n            </picture>\n            <p>\n              Cadastre-se para participar do nosso programa fidelidade e receber\n              descontos exclusivos!\n            </p>\n          </Call>\n          {status === \"blank\" && (\n            <Form onSubmit={handleSubmit}>\n              <div className=\"inputs\">\n                <Input\n                  nome=\"nome\"\n                  placeholder=\"Seu nome\"\n                  handleInput={handleInput}\n                  valor={lead.nome}\n                  valido={validado}\n                  className=\"cadastro-vip-input\"\n                  tipo=\"text\"\n                />\n                <Input\n                  nome=\"email\"\n                  placeholder=\"Seu E-mail\"\n                  handleInput={handleInput}\n                  valor={lead.email}\n                  valido={validado}\n                  className=\"cadastro-vip-input\"\n                  tipo=\"email\"\n                />\n                <InputMasked\n                  nome=\"celular\"\n                  valor={lead.celular}\n                  handleInput={handleInput}\n                  placeholder=\"Celular/Whatsapp\"\n                  valido={validado}\n                  tipo=\"text\"\n                  mask={celularMask}\n                  className=\"cadastro-vip-input\"\n                />\n              </div>\n              <ButtonSucesso type=\"submit\">Cadastrar</ButtonSucesso>\n            </Form>\n          )}\n          {status === \"enviando\" && (\n            <div className=\"loading-wrapper\">\n              <CircleLoading corCliente=\"laranja\" />\n            </div>\n          )}\n          {status === \"enviado\" && (\n            <span className=\"feedback\">\n              Obrigado. Aguarde novidades no seu e-mail!\n            </span>\n          )}\n          {status === \"erro\" && (\n            <span className=\"feedback\">\n              Ops, algo deu errado! Tente novamente mais tarde.\n            </span>\n          )}\n        </Conteudo>\n      </Container>\n    </Faixa>\n  );\n};\n\nFaixaCadastro.propTypes = {\n  unidade: PropTypes.string\n};\n\nexport default FaixaCadastro;\n"]},"metadata":{},"sourceType":"module"}